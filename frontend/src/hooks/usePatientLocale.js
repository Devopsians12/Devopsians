import { useEffect, useState } from "react";

const LOCALE_KEY = "patient_locale";
const LOCALE_EVENT = "patient-locale-change";

const translations = {
  en: {
    "lang.english": "English",
    "lang.arabic": "Arabic",
    "common.dismiss": "Got it",
    "common.lastUpdated": "Last updated {time}",
    "common.live": "Live updates",
    "common.offline": "Offline",
    "common.justNow": "just now",
    "common.minutesAgo": "{count} min ago",
    "common.minutesLabel": "minutes",
    "common.refresh": "Refresh",
    "common.searching": "Searching...",
    "common.loading": "Loading...",
    "common.unavailable": "Unavailable",
    "common.reserve": "Reserve ICU",
    "common.reserveShort": "Reserve",
    "common.cancel": "Cancel",
    "common.submit": "Submit",
    "common.optional": "Optional",
    "common.yes": "Yes",
    "common.no": "No",
    "patient.welcome": "Welcome, {name}",
    "patient.pendingReservation":
      "Your ICU reservation is pending. Waiting for receptionist approval...",
    "patient.noReservation":
      "You don't have an ICU reserved yet. Please select one below.",
    "patient.reservedIcu": "Reserved ICU",
    "patient.cancelReservation": "Cancel ICU Reservation",
    "patient.cancelling": "Cancelling...",
    "patient.trackAmbulance": "Track Ambulance / Manage Request",
    "patient.ambulanceRequested": "Ambulance Requested",
    "patient.ambulanceEnRoute": "Ambulance En Route",
    "patient.arrived": "You Have Arrived",
    "patient.bannerPending":
      "An ambulance has been assigned to pick you up. The crew will accept shortly.",
    "patient.bannerTransit":
      "Your ambulance is on the way to pick you up! Please be ready.",
    "patient.bannerArrived":
      "You have arrived at the hospital. The receptionist will check you in shortly.",
    "patient.pickupLocation": "Pickup Location",
    "patient.yourIcu": "Your Reserved ICU",
    "patient.hospital": "Hospital",
    "patient.specialization": "Specialization",
    "patient.status": "Status",
    "patient.dailyFee": "Daily Fee",
    "patient.totalFees": "Total Fees",
    "patient.feePaid": "Fee Paid",
    "patient.feeUnpaid": "Fee Not Paid",
    "patient.feedback": "Service Feedback",
    "patient.rateHospital": "Rate Hospital",
    "patient.rateTarget": "Rate the {target}",
    "patient.ratingPlaceholder": "Leave a comment (optional)...",
    "patient.gettingStarted": "Getting started",
    "patient.stepChoose": "Choose a hospital with available ICUs.",
    "patient.stepReserve": "Reserve an ICU to confirm your spot.",
    "patient.stepPickup": "Request an ambulance if you need pickup.",
    "patient.stepTrack": "Track your status in real time.",
    "patient.toastUserIdMissing": "User ID not found. Please log in again.",
    "patient.toastLoadFailed": "Failed to load patient data. Please try again.",
    "patient.toastCheckedIn": "You have been checked in to {hospitalName} - Room {room}!",
    "patient.toastAmbulanceOnWay":
      "{message} Your ambulance is heading to {hospitalName}!",
    "patient.toastPickupSent": "Your pickup request has been sent to the ambulance crew.",
    "patient.toastCheckedOut":
      "You have been checked out. Thank you for choosing our services.",
    "patient.toastReservationCancelled": "Your ICU reservation has been cancelled.",
    "patient.toastAmbulanceAccepted": "An ambulance is on the way to pick you up.",
    "patient.toastArrived": "You have arrived at the hospital. Please proceed to reception.",
    "patient.toastNoReservation": "No ICU reservation found to cancel.",
    "patient.toastCancelConfirm":
      "Are you sure you want to cancel your ICU reservation?",
    "patient.toastCancelSuccess": "ICU reservation cancelled successfully!",
    "patient.toastCancelFailed": "Failed to cancel reservation. Please try again.",
    "patient.toastRatingRequired": "Please select a rating from 1 to 5.",
    "patient.toastRatingThanks": "Thank you for your feedback on the {target}!",
    "patient.loadFailed": "Could not load patient data.",
    "icu.selectTitle": "Select Nearest Available ICU",
    "icu.selectSubtitle": "Real-time availability. Click Reserve to book your ICU.",
    "icu.searchPlaceholder": "Search by hospital name",
    "icu.allSpecializations": "All Specializations",
    "icu.specialization.surgical": "Surgical ICU",
    "icu.specialization.cardiac": "Cardiac ICU",
    "icu.specialization.neonatal": "Neonatal ICU",
    "icu.specialization.pediatric": "Pediatric ICU",
    "icu.specialization.neurological": "Neurological ICU",
    "icu.refresh": "Refresh",
    "icu.availableIcus": "Available ICUs",
    "icu.hospitalsAvailable": "Hospitals with Available ICUs",
    "icu.availableCount": "Available ICUs: {count}",
    "icu.specializations": "Specializations",
    "icu.noIcus": "No ICUs available at the moment.",
    "icu.distanceUnavailable": "Location unavailable",
    "icu.unknownHospital": "Unknown Hospital",
    "icu.finderTitle": "Find ICU",
    "icu.insightsTitle": "Insights",
    "icu.insightHospitals": "{count} hospitals available",
    "icu.insightIcus": "{count} ICUs available now",
    "icu.insightTopSpecialization": "Top specialization: {name} ({count})",
    "icu.insightAvgFee": "Average fee: {value} EGP/day",
    "icu.insightClosest": "Closest hospital: {name} ({distance} km)",
    "icu.liveLabel": "Live updates",
    "icu.justNow": "just now",
    "icu.minutesAgo": "{count} min ago",
    "icu.reservationTitle": "Complete Your Reservation",
    "icu.pickupQuestion": "Do you need ambulance pickup?",
    "icu.pickupYes": "Yes, I need ambulance pickup",
    "icu.pickupNo": "No, I will come directly",
    "icu.pickupAddress": "Your Current Location/Address",
    "icu.pickupAddressPlaceholder": "Enter your current address for pickup",
    "icu.confirmReservation": "Confirm Reservation",
    "icu.reserving": "Reserving...",
    "icu.toastReserved": "ICU at {hospitalName} was just reserved",
    "icu.toastAvailable": "A new ICU became available.",
    "icu.toastStatusUpdate": "ICU status updated at {hospitalName}",
    "icu.toastLogin": "Please log in to reserve an ICU.",
    "icu.toastPickupRequired": "Please enter your pickup location",
    "icu.toastReservedRedirect": "ICU reserved. Redirecting to your dashboard...",
    "icu.toastReservationFailed": "Reservation failed. Please try again.",
    "map.loading": "Loading...",
    "map.myLocation": "ðŸ“ My Location",
    "map.yourLocation": "ðŸ“ Your Location",
    "map.address": "Address",
    "map.contact": "Contact",
    "map.distance": "Distance",
    "map.specialization": "Specialization",
    "map.room": "Room",
    "map.fee": "Fee",
    "map.ambulance": "Ambulance",
    "map.driver": "Driver",
    "map.status": "Status",
    "map.eta": "ETA",
    "map.destination": "To",
    "ambulance.title": "Request Ambulance Pickup",
    "ambulance.subtitle": "Select your pickup location and request an ambulance",
    "ambulance.activeRequest": "Active Ambulance Request",
    "ambulance.pickupLocation": "Pickup Location",
    "ambulance.hospital": "Hospital",
    "ambulance.urgency": "Urgency",
    "ambulance.requested": "Requested",
    "ambulance.enRoute": "Ambulance En Route",
    "ambulance.crew": "Crew",
    "ambulance.eta": "ETA",
    "ambulance.distance": "Distance",
    "ambulance.imAway": "I'm {distance} km away",
    "ambulance.etaRoute": "ETA (route)",
    "ambulance.cancelRequest": "Cancel Request",
    "ambulance.liveMap": "Live Ambulance Location",
    "ambulance.pickupAddress": "Pickup Address ({optional})",
    "ambulance.pickupHint": "Or click on the map below to set your pickup location",
    "ambulance.urgencyLevel": "Urgency Level",
    "ambulance.requestPickup": "Request Ambulance",
    "ambulance.selectPickupOnMap": "Select Pickup Location on Map",
    "ambulance.clickMapHint": "Click anywhere on the map to set your pickup location",
    "ambulance.urgencyNormal": "Normal",
    "ambulance.urgencyUrgent": "Urgent",
    "ambulance.urgencyCritical": "Critical",
    "ambulance.notesLabel": "Additional Notes ({optional})",
    "ambulance.notesPlaceholder": "Any special instructions or medical conditions...",
    "ambulance.toastArrivedAgain":
      "You have arrived. You can request an ambulance again if needed.",
    "ambulance.toastCancelled": "Your ambulance request was cancelled",
    "ambulance.toastLoadDetailsFailed": "Failed to load your details",
    "ambulance.toastPickupUpdated": "Pickup location updated to: {lat}, {lng}",
    "ambulance.toastSelectPickup": "Please select a pickup location on the map",
    "ambulance.toastNeedReservation":
      "You must have an ICU reservation before requesting an ambulance",
    "ambulance.toastRequestSent":
      "Ambulance request sent. Waiting for a crew to accept...",
    "ambulance.toastRequestFailed": "Failed to send ambulance request",
    "ambulance.toastCancelSuccess": "Ambulance request cancelled",
    "ambulance.toastCancelFailed": "Failed to cancel request",
    "ambulance.toastCancelConfirm": "Are you sure you want to cancel your ambulance request?",
    "ambulance.sending": "Sending Request...",
    "ambulance.selected": "Selected: {lat}, {lng}",
  },
  ar: {
    "lang.english": "English",
    "lang.arabic": "Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©",
    "common.dismiss": "ØªÙ…Ø§Ù…",
    "common.lastUpdated": "Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ« {time}",
    "common.live": "ØªØ­Ø¯ÙŠØ«Ø§Øª Ù…Ø¨Ø§Ø´Ø±Ø©",
    "common.offline": "ØºÙŠØ± Ù…ØªØµÙ„",
    "common.justNow": "Ø§Ù„Ø¢Ù†",
    "common.minutesAgo": "Ù…Ù†Ø° {count} Ø¯Ù‚ÙŠÙ‚Ø©",
    "common.minutesLabel": "Ø¯Ù‚ÙŠÙ‚Ø©",
    "common.refresh": "ØªØ­Ø¯ÙŠØ«",
    "common.searching": "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø«...",
    "common.loading": "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...",
    "common.unavailable": "ØºÙŠØ± Ù…ØªØ§Ø­",
    "common.reserve": "Ø§Ø­Ø¬Ø² Ø§Ù„Ø¹Ù†Ø§ÙŠØ©",
    "common.reserveShort": "Ø§Ø­Ø¬Ø²",
    "common.cancel": "Ø¥Ù„ØºØ§Ø¡",
    "common.submit": "Ø¥Ø±Ø³Ø§Ù„",
    "common.optional": "Ø§Ø®ØªÙŠØ§Ø±ÙŠ",
    "common.yes": "Ù†Ø¹Ù…",
    "common.no": "Ù„Ø§",
    "patient.welcome": "Ø£Ù‡Ù„Ø§Ù‹ {name}",
    "patient.pendingReservation":
      "Ø­Ø¬Ø² Ø§Ù„Ø¹Ù†Ø§ÙŠØ© ÙÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±. Ø¬Ø§Ø±ÙŠ Ø§Ù†ØªØ¸Ø§Ø± ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø§Ø³ØªÙ‚Ø¨Ø§Ù„...",
    "patient.noReservation": "Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø­Ø¬Ø² Ø¹Ù†Ø§ÙŠØ© Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†. Ø§Ø®ØªØ± Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¨Ø§Ù„Ø£Ø³ÙÙ„.",
    "patient.reservedIcu": "Ø§Ù„Ø¹Ù†Ø§ÙŠØ© Ø§Ù„Ù…Ø­Ø¬ÙˆØ²Ø©",
    "patient.cancelReservation": "Ø¥Ù„ØºØ§Ø¡ Ø­Ø¬Ø² Ø§Ù„Ø¹Ù†Ø§ÙŠØ©",
    "patient.cancelling": "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ù„ØºØ§Ø¡...",
    "patient.trackAmbulance": "ØªØªØ¨Ø¹ Ø§Ù„Ø¥Ø³Ø¹Ø§Ù / Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ù„Ø¨",
    "patient.ambulanceRequested": "ØªÙ… Ø·Ù„Ø¨ Ø§Ù„Ø¥Ø³Ø¹Ø§Ù",
    "patient.ambulanceEnRoute": "Ø§Ù„Ø¥Ø³Ø¹Ø§Ù ÙÙŠ Ø§Ù„Ø·Ø±ÙŠÙ‚",
    "patient.arrived": "ØªÙ… Ø§Ù„ÙˆØµÙˆÙ„",
    "patient.bannerPending":
      "ØªÙ… ØªØ¹ÙŠÙŠÙ† Ø¥Ø³Ø¹Ø§Ù Ù„Ø§Ù„ØªÙ‚Ø§Ø·Ùƒ ÙˆØ³ÙŠØªÙ… Ø§Ù„Ù‚Ø¨ÙˆÙ„ Ù‚Ø±ÙŠØ¨Ø§Ù‹.",
    "patient.bannerTransit":
      "Ø§Ù„Ø¥Ø³Ø¹Ø§Ù ÙÙŠ Ø§Ù„Ø·Ø±ÙŠÙ‚ Ù„Ø§Ù„ØªÙ‚Ø§Ø·Ùƒ. Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ø§Ø³ØªØ¹Ø¯Ø§Ø¯.",
    "patient.bannerArrived":
      "ÙˆØµÙ„Øª Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø³ØªØ´ÙÙ‰. Ø³ÙŠØªÙ… Ø¥Ù†Ù‡Ø§Ø¡ Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù‚Ø±ÙŠØ¨Ø§Ù‹.",
    "patient.pickupLocation": "Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø§Ù„ØªÙ‚Ø§Ø·",
    "patient.yourIcu": "Ø§Ù„Ø¹Ù†Ø§ÙŠØ© Ø§Ù„Ù…Ø­Ø¬ÙˆØ²Ø©",
    "patient.hospital": "Ø§Ù„Ù…Ø³ØªØ´ÙÙ‰",
    "patient.specialization": "Ø§Ù„ØªØ®ØµØµ",
    "patient.status": "Ø§Ù„Ø­Ø§Ù„Ø©",
    "patient.dailyFee": "Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„ÙŠÙˆÙ…ÙŠØ©",
    "patient.totalFees": "Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±Ø³ÙˆÙ…",
    "patient.feePaid": "ØªÙ… Ø§Ù„Ø¯ÙØ¹",
    "patient.feeUnpaid": "Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¯ÙØ¹",
    "patient.feedback": "ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø®Ø¯Ù…Ø©",
    "patient.rateHospital": "Ù‚ÙŠÙ‘Ù… Ø§Ù„Ù…Ø³ØªØ´ÙÙ‰",
    "patient.rateTarget": "Ù‚ÙŠÙ‘Ù… {target}",
    "patient.ratingPlaceholder": "Ø§ÙƒØªØ¨ ØªØ¹Ù„ÙŠÙ‚Ø§Ù‹ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)...",
    "patient.gettingStarted": "Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù†",
    "patient.stepChoose": "Ø§Ø®ØªØ± Ù…Ø³ØªØ´ÙÙ‰ Ø¨Ù‡ Ø¹Ù†Ø§ÙŠØ© Ù…ØªØ§Ø­Ø©.",
    "patient.stepReserve": "Ø§Ø­Ø¬Ø² Ø¹Ù†Ø§ÙŠØ© Ù„ØªØ£ÙƒÙŠØ¯ Ù…ÙƒØ§Ù†Ùƒ.",
    "patient.stepPickup": "Ø§Ø·Ù„Ø¨ Ø¥Ø³Ø¹Ø§Ù Ø¥Ø°Ø§ ÙƒÙ†Øª ØªØ­ØªØ§Ø¬ Ø§Ù„ØªÙˆØµÙŠÙ„.",
    "patient.stepTrack": "ØªØ§Ø¨Ø¹ Ø­Ø§Ù„ØªÙƒ Ù„Ø­Ø¸Ø© Ø¨Ù„Ø­Ø¸Ø©.",
    "patient.toastUserIdMissing": "ØªØ¹Ø°Ø± Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…. ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.",
    "patient.toastLoadFailed": "ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø±ÙŠØ¶. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.",
    "patient.toastCheckedIn": "ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„Ùƒ ÙÙŠ {hospitalName} - ØºØ±ÙØ© {room}!",
    "patient.toastAmbulanceOnWay": "{message} Ø§Ù„Ø¥Ø³Ø¹Ø§Ù ÙÙŠ Ø§Ù„Ø·Ø±ÙŠÙ‚ Ø¥Ù„Ù‰ {hospitalName}!",
    "patient.toastPickupSent": "ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø¥Ø³Ø¹Ø§Ù Ø¥Ù„Ù‰ Ø§Ù„Ø·Ø§Ù‚Ù….",
    "patient.toastCheckedOut": "ØªÙ… Ø¥Ù†Ù‡Ø§Ø¡ Ø¥Ù‚Ø§Ù…ØªÙƒ. Ø´ÙƒØ±Ø§Ù‹ Ù„Ø§Ø®ØªÙŠØ§Ø±Ùƒ Ø®Ø¯Ù…Ø§ØªÙ†Ø§.",
    "patient.toastReservationCancelled": "ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø­Ø¬Ø² Ø§Ù„Ø¹Ù†Ø§ÙŠØ©.",
    "patient.toastAmbulanceAccepted": "Ø§Ù„Ø¥Ø³Ø¹Ø§Ù ÙÙŠ Ø§Ù„Ø·Ø±ÙŠÙ‚ Ù„Ø§Ù„ØªÙ‚Ø§Ø·Ùƒ.",
    "patient.toastArrived": "ÙˆØµÙ„Øª Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø³ØªØ´ÙÙ‰. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªÙˆØ¬Ù‡ Ù„Ù„Ø§Ø³ØªÙ‚Ø¨Ø§Ù„.",
    "patient.toastNoReservation": "Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø­Ø¬Ø² Ø¹Ù†Ø§ÙŠØ© Ù„Ø¥Ù„ØºØ§Ø¦Ù‡.",
    "patient.toastCancelConfirm": "Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ù„ØºØ§Ø¡ Ø­Ø¬Ø² Ø§Ù„Ø¹Ù†Ø§ÙŠØ©ØŸ",
    "patient.toastCancelSuccess": "ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø­Ø¬Ø² Ø¨Ù†Ø¬Ø§Ø­!",
    "patient.toastCancelFailed": "ÙØ´Ù„ Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø­Ø¬Ø². Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.",
    "patient.toastRatingRequired": "ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± ØªÙ‚ÙŠÙŠÙ… Ù…Ù† 1 Ø¥Ù„Ù‰ 5.",
    "patient.toastRatingThanks": "Ø´ÙƒØ±Ø§Ù‹ Ù„ØªÙ‚ÙŠÙŠÙ…Ùƒ Ù„Ù€ {target}!",
    "patient.loadFailed": "ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø±ÙŠØ¶.",
    "icu.selectTitle": "Ø§Ø®ØªÙŠØ§Ø± Ø£Ù‚Ø±Ø¨ Ø¹Ù†Ø§ÙŠØ© Ù…ØªØ§Ø­Ø©",
    "icu.selectSubtitle": "ØªØ­Ø¯ÙŠØ«Ø§Øª ÙÙˆØ±ÙŠØ©. Ø§Ø¶ØºØ· Ø­Ø¬Ø² Ù„ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¹Ù†Ø§ÙŠØ©.",
    "icu.searchPlaceholder": "Ø§Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ´ÙÙ‰",
    "icu.allSpecializations": "ÙƒÙ„ Ø§Ù„ØªØ®ØµØµØ§Øª",
    "icu.specialization.surgical": "Ø¹Ù†Ø§ÙŠØ© Ø¬Ø±Ø§Ø­ÙŠØ©",
    "icu.specialization.cardiac": "Ø¹Ù†Ø§ÙŠØ© Ù‚Ù„Ø¨ÙŠØ©",
    "icu.specialization.neonatal": "Ø¹Ù†Ø§ÙŠØ© Ø­Ø¯ÙŠØ«ÙŠ Ø§Ù„ÙˆÙ„Ø§Ø¯Ø©",
    "icu.specialization.pediatric": "Ø¹Ù†Ø§ÙŠØ© Ø£Ø·ÙØ§Ù„",
    "icu.specialization.neurological": "Ø¹Ù†Ø§ÙŠØ© Ø¹ØµØ¨ÙŠØ©",
    "icu.refresh": "ØªØ­Ø¯ÙŠØ«",
    "icu.availableIcus": "Ø¹Ù†Ø§ÙŠØ§Øª Ù…ØªØ§Ø­Ø©",
    "icu.hospitalsAvailable": "Ù…Ø³ØªØ´ÙÙŠØ§Øª Ø¨Ù‡Ø§ Ø¹Ù†Ø§ÙŠØ© Ù…ØªØ§Ø­Ø©",
    "icu.availableCount": "Ø§Ù„Ø¹Ù†Ø§ÙŠØ§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©: {count}",
    "icu.specializations": "Ø§Ù„ØªØ®ØµØµØ§Øª",
    "icu.noIcus": "Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù†Ø§ÙŠØ§Øª Ù…ØªØ§Ø­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹.",
    "icu.distanceUnavailable": "Ø§Ù„Ø¹Ù†ÙˆØ§Ù† ØºÙŠØ± Ù…ØªØ§Ø­",
    "icu.unknownHospital": "Ù…Ø³ØªØ´ÙÙ‰ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ",
    "icu.finderTitle": "Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø¹Ù†Ø§ÙŠØ©",
    "icu.insightsTitle": "Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø³Ø±ÙŠØ¹Ø©",
    "icu.insightHospitals": "{count} Ù…Ø³ØªØ´ÙÙ‰ Ù…ØªØ§Ø­",
    "icu.insightIcus": "{count} Ø¹Ù†Ø§ÙŠØ© Ù…ØªØ§Ø­Ø© Ø§Ù„Ø¢Ù†",
    "icu.insightTopSpecialization": "Ø£ÙƒØ«Ø± ØªØ®ØµØµ Ù…ØªØ§Ø­: {name} ({count})",
    "icu.insightAvgFee": "Ù…ØªÙˆØ³Ø· Ø§Ù„Ø±Ø³ÙˆÙ…: {value} Ø¬.Ù…/ÙŠÙˆÙ…",
    "icu.insightClosest": "Ø£Ù‚Ø±Ø¨ Ù…Ø³ØªØ´ÙÙ‰: {name} ({distance} ÙƒÙ…)",
    "icu.liveLabel": "ØªØ­Ø¯ÙŠØ«Ø§Øª Ù…Ø¨Ø§Ø´Ø±Ø©",
    "icu.justNow": "Ø§Ù„Ø¢Ù†",
    "icu.minutesAgo": "Ù…Ù†Ø° {count} Ø¯Ù‚ÙŠÙ‚Ø©",
    "icu.reservationTitle": "Ø£ÙƒÙ…Ù„ Ø§Ù„Ø­Ø¬Ø²",
    "icu.pickupQuestion": "Ù‡Ù„ ØªØ­ØªØ§Ø¬ Ø¥Ø³Ø¹Ø§ÙØŸ",
    "icu.pickupYes": "Ù†Ø¹Ù…ØŒ Ø£Ø­ØªØ§Ø¬ Ø¥Ø³Ø¹Ø§Ù",
    "icu.pickupNo": "Ù„Ø§ØŒ Ø³Ø£ØµÙ„ Ø¨Ù†ÙØ³ÙŠ",
    "icu.pickupAddress": "Ø¹Ù†ÙˆØ§Ù†Ùƒ Ø§Ù„Ø­Ø§Ù„ÙŠ",
    "icu.pickupAddressPlaceholder": "Ø§ÙƒØªØ¨ Ø¹Ù†ÙˆØ§Ù†Ùƒ Ø§Ù„Ø­Ø§Ù„ÙŠ Ù„Ù„Ø§Ø³ØªÙ‚Ø¨Ø§Ù„",
    "icu.confirmReservation": "ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø²",
    "icu.reserving": "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­Ø¬Ø²...",
    "icu.toastReserved": "ØªÙ… Ø­Ø¬Ø² Ø¹Ù†Ø§ÙŠØ© ÙÙŠ {hospitalName}",
    "icu.toastAvailable": "Ø£ØµØ¨Ø­Øª Ø¹Ù†Ø§ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø© Ù…ØªØ§Ø­Ø©.",
    "icu.toastStatusUpdate": "ØªÙ… ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø¹Ù†Ø§ÙŠØ© ÙÙŠ {hospitalName}",
    "icu.toastLogin": "ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ø­Ø¬Ø² Ø¹Ù†Ø§ÙŠØ©.",
    "icu.toastPickupRequired": "ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø§Ù„ØªÙ‚Ø§Ø·",
    "icu.toastReservedRedirect": "ØªÙ… Ø§Ù„Ø­Ø¬Ø². Ø¬Ø§Ø±ÙŠ ØªØ­ÙˆÙŠÙ„Ùƒ Ù„Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…...",
    "icu.toastReservationFailed": "ÙØ´Ù„ Ø§Ù„Ø­Ø¬Ø². Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.",
    "map.loading": "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...",
    "map.myLocation": "ðŸ“ Ù…ÙˆÙ‚Ø¹ÙŠ",
    "map.yourLocation": "ðŸ“ Ù…ÙˆÙ‚Ø¹Ùƒ",
    "map.address": "Ø§Ù„Ø¹Ù†ÙˆØ§Ù†",
    "map.contact": "Ø§Ù„ØªÙˆØ§ØµÙ„",
    "map.distance": "Ø§Ù„Ù…Ø³Ø§ÙØ©",
    "map.specialization": "Ø§Ù„ØªØ®ØµØµ",
    "map.room": "Ø§Ù„ØºØ±ÙØ©",
    "map.fee": "Ø§Ù„Ø±Ø³ÙˆÙ…",
    "map.ambulance": "Ø¥Ø³Ø¹Ø§Ù",
    "map.driver": "Ø§Ù„Ø³Ø§Ø¦Ù‚",
    "map.status": "Ø§Ù„Ø­Ø§Ù„Ø©",
    "map.eta": "Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªÙˆÙ‚Ø¹",
    "map.destination": "Ø§Ù„ÙˆØ¬Ù‡Ø©",
    "ambulance.title": "Ø·Ù„Ø¨ Ø¥Ø³Ø¹Ø§Ù",
    "ambulance.subtitle": "Ø­Ø¯Ø¯ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø§Ù„ØªÙ‚Ø§Ø· ÙˆØ§Ø·Ù„Ø¨ Ø¥Ø³Ø¹Ø§Ù",
    "ambulance.activeRequest": "Ø·Ù„Ø¨ Ø¥Ø³Ø¹Ø§Ù Ù†Ø´Ø·",
    "ambulance.pickupLocation": "Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø§Ù„ØªÙ‚Ø§Ø·",
    "ambulance.hospital": "Ø§Ù„Ù…Ø³ØªØ´ÙÙ‰",
    "ambulance.urgency": "Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©",
    "ambulance.requested": "ØªÙ… Ø§Ù„Ø·Ù„Ø¨",
    "ambulance.enRoute": "Ø§Ù„Ø¥Ø³Ø¹Ø§Ù ÙÙŠ Ø§Ù„Ø·Ø±ÙŠÙ‚",
    "ambulance.crew": "Ø§Ù„Ø·Ø§Ù‚Ù…",
    "ambulance.eta": "Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªÙˆÙ‚Ø¹",
    "ambulance.distance": "Ø§Ù„Ù…Ø³Ø§ÙØ©",
    "ambulance.imAway": "Ø£Ù†Ø§ Ø¹Ù„Ù‰ Ø¨Ø¹Ø¯ {distance} ÙƒÙ…",
    "ambulance.etaRoute": "Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªÙˆÙ‚Ø¹ (Ø§Ù„Ù…Ø³Ø§Ø±)",
    "ambulance.cancelRequest": "Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø·Ù„Ø¨",
    "ambulance.liveMap": "Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¥Ø³Ø¹Ø§Ù Ø§Ù„Ù…Ø¨Ø§Ø´Ø±",
    "ambulance.pickupAddress": "Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø§Ù„ØªÙ‚Ø§Ø· ({optional})",
    "ambulance.pickupHint": "Ø£Ùˆ Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ù„ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø§Ù„ØªÙ‚Ø§Ø·",
    "ambulance.urgencyLevel": "Ø¯Ø±Ø¬Ø© Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©",
    "ambulance.requestPickup": "Ø·Ù„Ø¨ Ø¥Ø³Ø¹Ø§Ù",
    "ambulance.selectPickupOnMap": "Ø­Ø¯Ø¯ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø§Ù„ØªÙ‚Ø§Ø· Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø±ÙŠØ·Ø©",
    "ambulance.clickMapHint": "Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ù„ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø§Ù„ØªÙ‚Ø§Ø·",
    "ambulance.urgencyNormal": "Ø¹Ø§Ø¯ÙŠØ©",
    "ambulance.urgencyUrgent": "Ø¹Ø§Ø¬Ù„Ø©",
    "ambulance.urgencyCritical": "Ø­Ø±Ø¬Ø©",
    "ambulance.notesLabel": "Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© ({optional})",
    "ambulance.notesPlaceholder": "Ø£ÙŠ ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø®Ø§ØµØ© Ø£Ùˆ Ø­Ø§Ù„Ø§Øª Ø·Ø¨ÙŠØ©...",
    "ambulance.toastArrivedAgain":
      "ØªÙ… Ø§Ù„ÙˆØµÙˆÙ„. ÙŠÙ…ÙƒÙ†Ùƒ Ø·Ù„Ø¨ Ø¥Ø³Ø¹Ø§Ù Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ø¥Ø°Ø§ Ø§Ø­ØªØ¬Øª.",
    "ambulance.toastCancelled": "ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø·Ù„Ø¨ Ø§Ù„Ø¥Ø³Ø¹Ø§Ù",
    "ambulance.toastLoadDetailsFailed": "ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ",
    "ambulance.toastPickupUpdated": "ØªÙ… ØªØ­Ø¯ÙŠØ« Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø§Ù„ØªÙ‚Ø§Ø· Ø¥Ù„Ù‰: {lat}ØŒ {lng}",
    "ambulance.toastSelectPickup": "ÙŠØ±Ø¬Ù‰ ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø§Ù„ØªÙ‚Ø§Ø· Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø±ÙŠØ·Ø©",
    "ambulance.toastNeedReservation": "ÙŠØ¬Ø¨ Ø­Ø¬Ø² Ø¹Ù†Ø§ÙŠØ© Ù‚Ø¨Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø¥Ø³Ø¹Ø§Ù",
    "ambulance.toastRequestSent": "ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø¥Ø³Ø¹Ø§Ù. ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù‚Ø¨ÙˆÙ„.",
    "ambulance.toastRequestFailed": "ÙØ´Ù„ Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø¥Ø³Ø¹Ø§Ù",
    "ambulance.toastCancelSuccess": "ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø·Ù„Ø¨ Ø§Ù„Ø¥Ø³Ø¹Ø§Ù",
    "ambulance.toastCancelFailed": "ÙØ´Ù„ Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø·Ù„Ø¨",
    "ambulance.toastCancelConfirm": "Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ù„ØºØ§Ø¡ Ø·Ù„Ø¨ Ø§Ù„Ø¥Ø³Ø¹Ø§ÙØŸ",
    "ambulance.sending": "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„...",
    "ambulance.selected": "Ø§Ù„Ù…Ø­Ø¯Ø¯: {lat}ØŒ {lng}",
  },
};

const resolveLocale = (value) => {
  if (!value) return "en";
  return value === "ar" ? "ar" : "en";
};

const formatMessage = (text, vars) => {
  if (!vars) return text;
  return text.replace(/\{(\w+)\}/g, (_, key) =>
    Object.prototype.hasOwnProperty.call(vars, key) ? String(vars[key]) : ""
  );
};

const usePatientLocale = () => {
  const [locale, setLocaleState] = useState(() => {
    if (typeof window === "undefined") return "en";
    return resolveLocale(window.localStorage.getItem(LOCALE_KEY));
  });

  useEffect(() => {
    if (typeof window === "undefined") return undefined;
    const handleLocaleChange = (event) => {
      const nextLocale = resolveLocale(event?.detail || window.localStorage.getItem(LOCALE_KEY));
      setLocaleState(nextLocale);
    };
    window.addEventListener(LOCALE_EVENT, handleLocaleChange);
    return () => window.removeEventListener(LOCALE_EVENT, handleLocaleChange);
  }, []);

  const setLocale = (next) => {
    const resolved = resolveLocale(next);
    setLocaleState(resolved);
    if (typeof window !== "undefined") {
      window.localStorage.setItem(LOCALE_KEY, resolved);
      window.dispatchEvent(new CustomEvent(LOCALE_EVENT, { detail: resolved }));
    }
  };

  const t = (key, vars) => {
    const table = translations[locale] || translations.en;
    const fallback = translations.en || {};
    const text = table[key] || fallback[key] || key;
    return formatMessage(text, vars);
  };

  return {
    locale,
    setLocale,
    t,
    dir: locale === "ar" ? "rtl" : "ltr",
  };
};

export default usePatientLocale;
